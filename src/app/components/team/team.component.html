<app-session-timeout></app-session-timeout>
<app-nav-bar
  [userName]="userName"
  (teamDetailsSubArea)="setTeamDetailsAreaActive($event)">
</app-nav-bar>
<div id="wrapper">
  <div class="alert alert-success alert-dismissible fade in centered" *ngIf="createAssessmentMessage == 'block'" [ngStyle]="{'display': createAssessmentMessage}">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    Assessment created successfully.
  </div>
  <div class="alert alert-success alert-dismissible fade in centered" *ngIf="updateTeamMessage == 'block'" [ngStyle]="{'display': updateTeamMessage}">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    Team updated successfully.
  </div>
  <div class="alert alert-success alert-dismissible fade in centered" *ngIf="updatePracticeScoreMessage == 'block'" [ngStyle]="{'display': updatePracticeScoreMessage}">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    Saved Team Practice.
  </div>
  <div id="breadcrumb-container" class="container" style="margin-top:80px">
    <app-breadcrumb 
      [userHome]="userHome"
      [partitionSymbolEngagement]="partitionSymbolEngagement"
      [engagementNameTitle]="engagementNameTitle"
      [engagementId]="engagementId"
      [teamId]="teamId"
      [partitionSymbolTeamProduct]="partitionSymbolTeamProduct"
      [teamNameTitle]="teamNameTitle"
      [legendsLink]="legendsLink">
    </app-breadcrumb>
  </div><br>
  <div id="main-container" class="container" style="min-height: 900px;">
    <ul id = "myTab" class = "nav nav-tabs">
      <li id="team-details-tab" class="active">
        <a href="#teamDetails" data-toggle = "tab" (click)="teamDetailsTabFunctionality()">
            Team Details
        </a>
      </li>
      <li id="assess-tab">
        <a href="#assess" data-toggle = "tab" (click)="assessTabFunctionality()">Assess</a>
      </li>
      <li id="reports-tab">
        <a href = "#reports" data-toggle = "tab" (click) = "loadReports()">Reports</a>
      </li>
      <span [hidden]="assessmentDropDown" style="float: right;">
        <table>
          <tr>
            <td style="border: 0;">
              <select 
                class="form-control" 
                id="selected-assessment-tag"
                *ngIf="assessments != 0; else selectionDropdownWithNoAssessments"
                (ngModelChange)="onAssessmentChange($event)"
                title="{{ selectedAssessmentName }}"
                [(ngModel)]="selectedAssessment"
                >
                <option *ngFor="let a of assessments;" id="a.id" [value]="a.id" title="{{ a.name }}">{{ a.name }}</option>
              </select>
              <ng-template #selectionDropdownWithNoAssessments>
                <select class="form-control">
                  <option title="Select Assessment Version">Select Assessment Version</option>
                </select>
              </ng-template>
            </td>
            <td style="border: 0; padding: 10px;">
                <a data-toggle="modal" data-target=".createAssessment"
                (click)="assessmentDefaults()">
                    <span style="vertical-align:middle;cursor:pointer;">
                      <i 
                        class="fa fa-plus-circle"
                        id="create-assessment-assess-tab" 
                        title="Create new assessment"
                        style="font-size: 18px;"></i>
                    </span>
                  </a>
            </td>
          </tr>
        </table>
      </span>  
    </ul>
  
   <div id = "myTabContent" class = "tab-content">
    <div class = "tab-pane fade active in" id = "teamDetails" style="margin-top: 20px;">
      <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="panel-title pull-left">
                  Team Information
                  <a data-toggle="modal" data-target="#updateTeam" (click)="teamDefaults()">
                    <span style="vertical-align:middle;cursor:pointer;">
                      <i class="fa fa-pencil" title="Edit team"></i>
                    </span>
                  </a>
                </div>
                <div class="panel-title pull-right">
                  <a 
                    data-toggle="collapse" 
                    data-parent="#accordion" 
                    href="#collapseEditTeamInfo" 
                    (click)="changeIcon('linkedEditTeamInfo')">
                    <i [ngClass]="linkedEditIconTeamInfo"></i>
                  </a>
                </div>
                <div class="clearfix"></div>
              </div>
          <div id="collapseEditTeamInfo" class="panel-collapse collapse in"> 
            <div class="panel-body">
              <div class="panel-body">
                <div class="panel-body">
                    <div class = "row">
                      <form 
                        class = "form-horizontal" 
                        id = "formEditTeam" 
                        name = "formEditTeam">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label col-md-4" for="name">Team Name</label>
                                <div class="col-md-8">
                                  <input 
                                    type="text" 
                                    name="teamName" 
                                    id="teamName" 
                                    value = "{{team?.name}}"
                                    readonly
                                    title="{{team?.name}}"
                                    class="form-control form-valid">       
                                </div>
                              </div>
                              <div class="form-group">
                                <label class="control-label col-md-4" for="team-description">Description</label>
                                <div class="col-md-8">
                                  <textarea                                
                                    name="teamDescription" 
                                    id="teamDescription" 
                                    rows="5"
                                    value = "{{team?.description}}"
                                    readonly
                                    title="{{team?.description}}"
                                    class="form-control form-valid">
                                  </textarea>
                                </div>
                              </div>
                              <div class="form-group">
                                <label class="control-label col-md-4" for="team-contact">Contacts</label>
                                <div class="col-md-8">
                                  <textarea 
                                    name="teamContact" 
                                    id="team-contact" 
                                    value = "{{team?.contact}}"
                                    rows="5"
                                    readonly
                                    title="{{team?.contact}}"
                                    class="form-control form-valid">
                                  </textarea>                              
                                </div>
                              </div>
                              
                              <div class="form-group">
                                <label class="control-label col-md-4" for="strategist">Strategist</label>
                                <div class="col-md-8">
                                  <input 
                                    type="text" 
                                    name="strategist" 
                                    id="strategist" 
                                    value = "{{team?.strategist?.firstName}} {{team?.strategist?.lastName}}"
                                    readonly
                                    title="{{team?.strategist?.firstName}} {{team?.strategist?.lastName}}"
                                    class="form-control form-valid">                                
                                </div>
                              </div>
                            </div>
                      </form>
                          <div class="col-md-6">
                            <div class="panel-group">
                              <div class="panel panel-default">
                                <div class="panel-heading" style="background-color: #6d6f71 !important;">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <h4 class="panel-title" style="padding: 5px;">
                                        Team Assessments
                                        <a data-toggle="modal" data-target=".createAssessment" (click)="assessmentDefaults()">
                                            <span style="vertical-align:middle;cursor:pointer;">
                                              <i class="fa fa-plus-circle" title="Create new assessment"></i>
                                            </span>
                                          </a>
                                      </h4>
                                    </div>
                                  </div>
                                </div>
                                <div id="collapse1" class="panel-collapse collapse in">
                                  <div class="panel-body" malihu-scrollbar [scrollbarOptions]="scrollbarOptions" style="height: auto; max-height: 290px;padding:0px;overflow-y: auto;">
                                    <div class="table-responsive" style="padding:0" *ngIf="assessments != 0; else tableWithNoAssessments">
                                      <table 
                                        class="table table-striped table-fixed"
                                        style="margin-bottom: 0;">
                                        <tbody>
                                           <tr *ngFor="let a of assessments;" (click)="setAssessmentTabActive(a.id, a.name);">
                                            <td style="padding-top: 12px;padding-bottom: 12px">
                                              <a href = "#assess" data-toggle = "tab" title="{{a.name}}" style="color: #000000;">
                                                {{a.name}}  
                                              </a>
                                            </td>
                                        </tr>
                                        </tbody>
                                      </table>
                                   </div>
                                  </div>
                                  <ng-template #tableWithNoAssessments>
                                      <div class="table-responsive" style="padding:0">
                                        <table class="table table-striped table-fixed" 
                                          style="text-align:center; width:100%; margin-bottom: 0;">
                                           <tbody>
                                            <tr>
                                              <td [colSpan]=3 title="You have no Assessement. Please create new Assessments.">
                                                You have no Assessement. Please create new Assessments.
                                              </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </div>
                                  </ng-template>
                                </div>
                              </div>
                              
                            </div>
                          </div>
                        </div>    
                    </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="panel-group">
        <div class="panel panel-default">
          <div class="panel-heading">
            <div class="panel-title pull-left">
              Linked Products
            </div>
            <div class="panel-title pull-right">
              <a 
                data-toggle="collapse" 
                data-parent="#accordion" 
                href="#collapseLinkedProduct" 
                (click)="changeIcon('linkedProTable')">
                <i [ngClass]="linkedProductsIconTable"></i>
              </a>
            </div>
            <div class="clearfix"></div>
          </div>
          <div id="collapseLinkedProduct" class="panel-collapse collapse in">
            <div class="panel-body">
              <div 
                class="table-responsive" 
                style="padding:0; height: auto;" 
                *ngIf="linkedProducts?.length>0; else tableWithNoLinkedProducts">
                <table 
                  class="table table-bordered table-fixed table-linked-products" 
                  style="text-align:center; width:100%; table-layout:fixed;">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Description</th>
                      <th>Strategist Name</th>
                      <th class="collapse-toggle-icon"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let lpNoPagination of linkedProductsNoPagination"
                        [routerLink]="['/product', lpNoPagination.engagement.id, lpNoPagination.engagement.name, lpNoPagination.id, lpNoPagination.name]">
                      <td *ngIf="lpNoPagination.isTextShorten" [clamp]="1" title="{{ lpNoPagination.name }}">{{ lpNoPagination.name }}</td>
                      <td *ngIf="lpNoPagination.isTextShorten" [clamp]="1" title="{{ lpNoPagination.description }}">{{ lpNoPagination.description }}</td>
                      <td *ngIf="lpNoPagination.isTextShorten" [clamp]="1" title="{{ lpNoPagination.strategist.firstName }} {{ lpNoPagination.strategist.lastName }}">{{ lpNoPagination.strategist.firstName }} {{ lpNoPagination.strategist.lastName }}</td>
  
                      <td *ngIf="!lpNoPagination.isTextShorten">{{ lpNoPagination.name }}</td>
                      <td *ngIf="!lpNoPagination.isTextShorten">{{ lpNoPagination.description }}</td>
                      <td *ngIf="!lpNoPagination.isTextShorten">
                        {{ lpNoPagination.strategist.firstName }} {{ lpNoPagination.strategist.lastName }}
                      </td>
                      <td class="collapse-toggle-icon" (click)="toggleShortenLinkedProductText(lpNoPagination.id)">
                        <i
                          class="fa"
                          [class.fa-caret-down] = "lpNoPagination.isTextShorten"
                          [class.fa-caret-up] = "!lpNoPagination.isTextShorten"></i>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <ng-template #tableWithNoLinkedProducts>
                <div class="table-responsive" style="padding:0">
                  <table class="table table-bordered table-fixed table-linked-products" 
                    style="text-align:center; width:100%; table-layout:fixed;">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Strategist Name</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td [colSpan]=3 style="text-align: center;">
                          No records found.
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
            </ng-template>
            <div class="col-md-12 text-center" *ngIf="linkedProductsNoPagination?.length > 0">
              <ul class="pagination pagination-sm" style="margin-top: 5px;">
                  <li [ngClass]="{'disabled':page==0}">
                    <a   
                      (click)="setFirstPageIndex()">
                      <i class="fa fa-step-backward"></i>
                    </a>
                  </li>
                  <li [ngClass]="{'disabled':page==0}">
                    <a  (click)="setPreviousPageIndex(page)">
                      <i class="fa fa-backward"></i>
                    </a>
                  </li>
                
                  <li *ngFor="let p of pages;" 
                    [ngClass]="{'active':page == p-1}">
                    <a (click)="setPageIndex(p-1)">{{p}}</a>
                  </li>
                
                  <li [ngClass]="{'disabled':page==pageNumber-1}">
                    <a  
                       
                      (click)="setNextPageIndex()">
                      <i class="fa fa-forward"></i>
                    </a>
                  </li> 
                  <li [ngClass]="{'disabled':page==pageNumber-1}">
                    <a  (click)="setLastPageIndex()">
                      <i class="fa fa-step-forward"></i>
                    </a>
                  </li>
                </ul>
          </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class = "tab-pane fade" id = "assess" style="margin-top: 20px;">
      <div 
        class="panel-group" 
        *ngFor="let prac of practiceScore; let i = index;" 
        style="margin-bottom: 0;">
        <div class="panel panel-default" style="border-radius: 0;">
          <div 
            class="panel-heading"
            (click)="getCurrentPracticeId(this.prac.practice.id, this.prac.id); current=i" 
            [attr.href]="prac.accordianHref"
            style="height: 40px; cursor: pointer; background-color: #6d6f71 !important;">
            <div class="panel-title pull-left">
              <i class="panel-caret fa fa-caret-right"
                id = "{{ this.prac.id }}" 
                ></i>
              <span>
                {{ prac.practice.subject }}
              </span>
            </div>
            <div class="panel-title pull-right">
              <span>
                <span 
                  [ngClass]=
                  "{
                      'metrics-with-value': prac.currentMatDis>0, 
                      'metrics-without-value': prac.currentMatDis==0
                    }">CM</span>
                <span *ngIf="prac.currentMatDis>0">- {{ prac.currentMatDis }}</span>
              </span>
              <span>|
                <span [ngClass]=
                "{
                    'metrics-with-value': prac.desiredMatDis>0, 
                    'metrics-without-value': prac.desiredMatDis==0
                  }">TM</span>
                <span *ngIf="prac.desiredMatDis>0">- {{ prac.desiredMatDis }}</span>
              </span>
              <span>|
                <span [ngClass]=
                "{
                    'metrics-with-value': prac.valueNextDis>0, 
                    'metrics-without-value': prac.valueNextDis==0
                  }">VN</span>
                <span *ngIf="prac.valueNextDis>0">- {{ prac.valueNextDis }}</span>
              </span>
              <span>|
              <span [ngClass]=
                "{
                    'metrics-with-value': prac.complexityNextDis>0, 
                    'metrics-without-value': prac.complexityNextDis==0
                  }">CN</span>
                <span *ngIf="prac.complexityNextDis>0">- {{ prac.complexityNextDis }}</span>
              </span>
              <span>|
                <span [ngClass]=
                "{
                    'metrics-with-value': prac.priorityOrderDis>0, 
                    'metrics-without-value': prac.priorityOrderDis==0
                  }">PO</span>
                <span *ngIf="prac.priorityOrderDis>0">- {{ prac.priorityOrderDis }}</span>
              </span>
              <span>|
                <span [ngClass]=
                "{
                    'metrics-with-value': prac.priorityRationaleDis!=0, 
                    'metrics-without-value': prac.priorityRationaleDis==0
                  }">PR</span>
                <span *ngIf="prac.priorityRationaleDis != 0">- {{ prac.priorityRationaleDis }}</span>
              </span>
              <span>|
                <span>
                  <span class="fa fa-comment" [ngStyle]="{ 'color': prac.commentsDis.length>0 ? '#ffffff' : '#cccccc' }"></span>
                </span>
              </span>
            </div>
          </div>
          <div id="{{prac.id}}" class="panel-collapse collapse assess-panel-body" style="cursor: default;">
            <div class="panel-body">
              <div class="col-md-6" style="padding: 0; margin: 0;">
                <table class="table table-bordered assess-content">
                  <tr>
                    <td  class="col-md-2"><b>Question:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.question }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Metrics:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.metric }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Tin:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.tin }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Bronze:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.bronze }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Silver:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.silver }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Gold:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.gold }}</td>
                  </tr>
                  <tr>
                    <td class="col-md-2"><b>Platinum:</b></td>
                    <td class="col-md-10 practice-table">{{ prac.practice.platinum }}</td>
                  </tr>
                </table>
              </div>
              <form 
              id = "formSavePracticeScore" 
              name = "formSavePracticeScore" 
              #practiceScoreData = "ngForm" 
              (ngSubmit) = "savePracticeScore(practiceScoreData.value)">
                <div class="col-md-6" style="padding: 0; margin: 0;">
                  <table class="table table-bordered assess-input-data">
                    <tr>
                      <td class="col-md-6">
                        <label for="currentMaturity">Current Maturity</label>
                        <select 
                          class="form-control" 
                          (ngModelChange)="onCurrentMaturityChange($event, i)"
                          id="currentMaturity"
                          title="{{ currentMaturityTitle }}"
                          [(ngModel)]="prac.currentMaturity"
                          name="currentMaturity">
                          <option *ngFor="let mv of maturityValues" [value]="mv.value" title="{{ mv.text }}"> {{ mv.text }} </option>
                        </select>
                      </td>
                      <td class="col-md-6">
                        <label for="desiredMaturity">Target Maturity</label>
                        <select 
                          class="form-control" 
                          id="desiredMaturity"
                          (change)="changeTitle($event, 'desiredMaturityTitle')"
                          title="{{ desiredMaturityTitle }}"
                          [(ngModel)]="prac.desiredMaturity"
                          name="desiredMaturity">
                          <option 
                            *ngFor="let tmv of targetMaturityValues;" 
                            [value]="tmv.value"
                            title="{{ tmv.text }}"
                            > {{ tmv.text }} </option>
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <td class="col-md-6">
                        <label for="valueNext">Value to Next Maturity</label>
                        <select 
                          class="form-control" 
                          id="valueNext"
                          (change)="changeTitle($event, 'valNextMaturityTitle')"
                          [(ngModel)]="prac.valueNext"
                          title="{{ valNextMaturityTitle }}"
                          name="valueNext">
                          <option value="0" title=""></option>
                          <option value="5" title="Highest">Highest</option>
                          <option value="4" title="High">High</option>
                          <option value="3" title="Medium">Medium</option>
                          <option value="2" title="Low">Low</option>
                          <option value="1" title="Lowest">Lowest</option> 
                        </select>
                      </td>
                      <td class="col-md-6">
                        <label for="complexityNext">Complexity to Next Maturity</label>
                        <select 
                          class="form-control" 
                          id="complexityNext"
                          (change)="changeTitle($event, 'complexityNextMaturityTitle')"
                          [(ngModel)]="prac.complexityNext"
                          title="{{ complexityNextMaturityTitle }}"
                          name="complexityNext">
                          <option value="0" title=""></option>
                          <option value="5" title="Highest">Highest</option>
                          <option value="4" title="High">High</option>
                          <option value="3" title="Medium">Medium</option>
                          <option value="2" title="Low">Low</option>
                          <option value="1" title="Lowest">Lowest</option> 
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <td class="col-md-6">
                        <label for="priorityOrder">Priority Order</label>
                        <select 
                          class="form-control" 
                          id="priorityOrder"
                          (change)="changeTitle($event, 'priorityOrderTitle')"
                          [(ngModel)]="prac.priorityOrder"
                          title="{{ priorityOrderTitle }}"
                          name="priorityOrder">
                          <option value="0" title=""></option>
                          <option value="5" title="Highest">Highest</option>
                          <option value="4" title="High">High</option>
                          <option value="3" title="Medium">Medium</option>
                          <option value="2" title="Low">Low</option>
                          <option value="1" title="Lowest">Lowest</option> 
                        </select>
                      </td>
                      <td class="col-md-6">
                        <label for="priorityRationale">Priority Rationale</label>
                        <select 
                          class="form-control" 
                          id="priorityRationale"
                          (change)="changeTitle($event, 'priorityRationaleTitle')"
                          title="{{ priorityRationaleTitle }}"
                          [(ngModel)]="prac.priorityRationale"
                          name="priorityRationale">
                          <option value="0"></option>
                          <option value="TIN" title="Tin">Tin</option>
                          <option value="INTERNAL_INITIATIVE" title="Internal Initiative">Internal Initiative</option>
                          <option value="VALUE_COMPLEXITY" title="Value vs Complexity">Value vs Complexity</option>
                          <option value="HIGHEST_VALUE" title="Highest Value">Highest Value</option>
                          <option value="LOWEST_COMPLEXITY" title="Lowest Complexity">Lowest Complexity</option>
                          <option value="LEVELSET_TEAM_ORG" title="Level-Set Team/Org">Level-Set Team/Org</option>
                          <option value="DISTANCE_TO_DESIRED_MATURITY" title="Distance to Target Maturity">Distance to Target Maturity</option>
                          <option value="NO_ACTION_TARGET_MATURITY_REACHED" title="No Action - Target Maturity Reached">No Action - Target Maturity Reached</option>
                          <option value="NO_ACTION_OTHER" title="No Action - Other">No Action - Other</option> 
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <td [colSpan]=2>
                        <div class="form-group">
                          <label for="comments">Comments</label>
                          <textarea
                           class="form-control" 
                           rows="5" 
                           id="comments"
                           title="{{ prac.comments }}"
                           [ngClass]=
                            "{	'form-invalid' : practiceScoreError?.comments, 
                                'form-valid' : !practiceScoreError?.comments
                            }"
                           [(ngModel)]="prac.comments"
                          name="comment">
                          </textarea>
                          <div class="form-error-text" *ngIf = "practiceScoreError?.comments">
                            <span class="text text-danger">
                              {{practiceScoreError.comments}}
                            </span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td [colSpan]=2>
                        <input 
                          type="submit" 
                          class="btn btn-primary" 
                          value = "Save Practice"
                          style="float: right;">
                      </td>
                    </tr>  
                  </table>
                </div>
              </form>
              
            </div>
          </div>
        </div>      
    </div> 
    </div>
  
    <div class = "tab-pane fade" id = "reports" >
      <div class="container"  style="margin-top:30px" *ngIf = "assessments?.length > 0">
        <div class="panel-group">
          <div class="panel panel-default">
              <div class="panel-heading">
                  <div class="panel-title pull-left">
                    Competency Table
                  </div>
                  <div class="panel-title pull-right">
                    <a 
                      data-toggle="collapse" 
                      data-parent="#accordion" 
                      href="#competencyPanelIcon" 
                      (click)="changeIcon('competencyPanelIcon')">
                      <i [ngClass]="competencyPanelIcon"></i>
                    </a>
                  </div>
                  <div class="clearfix"></div>
                </div>
            <div id="competencyPanelIcon" class="panel-collapse collapse in">
              <div class="panel-body">
                  <div class="row" *ngIf="competencies">
                    <div class="table-responsive" style="padding:0;min-height:500px;max-height:auto">
                      <table 
                        class="table table-bordered table-fixed table-competency"  
                        id = "competencyTable" 
                        style = "display:none; text-align:center; width:100%; table-layout:fixed;">
                        <thead>
                          <tr>
                            <th>Competency </th>
                            <th>Domain </th>
                            <th>Current Maturity </th>
                            <th>Target Maturity </th>
                            <th>Current's % of Target </th>
                            <th>Priority Order</th>
                            <th>Priority Rationale </th>
                            <th>Value to next </th>
                            <th>Complexity to next</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngIf = "sortFilterCompetencies?.length == 0">
                            <td colspan="9">
                                No records found with given criteria
                            </td>
                          </tr>
                          <tr *ngFor="let c of sortFilterCompetencies">
                            <td>{{c.subject}} </td>
                            <td>{{c.domain}} </td>
                            <td>{{showFormattedValue(c.currentMaturity)}} </td>
                            <td>{{showFormattedValue(c.desiredMaturity)}} </td>
                            <td>{{convertStringToNum(c.cmVsDm)}} </td>
                            <td>{{showFormattedValue(c.priorityOrder)}} </td>
                            <td>{{c.priorityRationale}} </td>
                            <td>{{showFormattedValue(c.valueNext)}} </td>
                            <td>{{showFormattedValue(c.complexityNext)}} </td>
                          </tr>
                        </tbody>
                      </table>
                      <table 
                        class="table table-bordered table-fixed table-competency removeHand" 
                        style="text-align:center; width:100%; table-layout:fixed;">
                        <thead>
                          <tr id = "competencyFilters">
                            <th sortCompetencyColumn [competencySortKey]="'subject'" 
                                           [data]="sortFilterCompetencies" 
                                           (click)="sortCompetencyHeaderClick('subject')" 
                                           [ngClass]="sortCompetencyClass('subject')">Competency </th>
                            <th sortCompetencyColumn [competencySortKey]="'domain'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('domain')" [ngClass]="sortCompetencyClass('domain')">Domain </th>
                            <th sortCompetencyColumn [competencySortKey]="'currentMaturity'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('currentMaturity')" [ngClass]="sortCompetencyClass('currentMaturity')">Current Maturity </th>
                            <th sortCompetencyColumn [competencySortKey]="'desiredMaturity'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('desiredMaturity')" [ngClass]="sortCompetencyClass('desiredMaturity')">Target Maturity </th>
                            <th sortCompetencyColumn [competencySortKey]="'cmVsDm'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('cmVsDm')" [ngClass]="sortCompetencyClass('cmVsDm')">Current's % of Target </th>
                            <th sortCompetencyColumn [competencySortKey]="'priorityOrder'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('priorityOrder')" [ngClass]="sortCompetencyClass('priorityOrder')">Priority Order </th>
                            <th sortCompetencyColumn [competencySortKey]="'priorityRationale'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('priorityRationale')" [ngClass]="sortCompetencyClass('priorityRationale')">Priority Rationale </th>
                            <th sortCompetencyColumn [competencySortKey]="'valueNext'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('valueNext')" [ngClass]="sortCompetencyClass('valueNext')">Value to next </th>
                            <th sortCompetencyColumn [competencySortKey]="'complexityNext'" [data]="sortFilterCompetencies" (click)="sortCompetencyHeaderClick('complexityNext')" [ngClass]="sortCompetencyClass('complexityNext')">Complexity to next </th>
                            <th class="collapse-toggle-icon"></th>
                          </tr>
                          <tr>
                              
                            <th>
                              <div class="multiselect" ngbDropdown>
                                <div class="selectbox" ngbDropdownToggle>
                                  <select class = "form-control competency-table-drop-down">
                                    <option>Competency</option>
                                  </select> 
                                  <div class="overselect" title="Competency"></div>
                                </div>
                                <div ngbDropdownMenu id="subjectChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;"> 
                                  <li style = "padding-left: 12px;padding-top: 6px;">
                                    <label title="Competency"> 
                                      <input 
                                            type="checkbox" 
                                            [(ngModel)]="subjectSelectedAll" 
                                            (change)="onCompetencyCheckAll($event, 'subject', -1)"> 
                                        Competency
                                    </label>
                                  </li>
                                  <li *ngFor="let subject of teamSubjects" 
                                      style = "padding-left: 12px;">
                                    <label 
                                      title="{{subject.itemName}}"
                                      style="
                                        white-space: nowrap; 
                                        width: 190px; 
                                        overflow: hidden;
                                        text-overflow: ellipsis; 
                                        ">
                                      <input 
                                          type="checkbox" 
                                          [(ngModel)]="subject.selected" 
                                          value="{{subject.itemName}}" 
                                          (change)="onCompetencyCheckboxChange(subject, $event, 'subject', -1)">
                                            {{subject.itemName}}
                                      </label>
                                  </li>
                                </div>
                              </div>
                            </th>
                            <th>
                              
                                
                                <div class="multiselect" ngbDropdown>
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>Domain</option>
                                      </select>
                                      <div class="overselect" title="Domain"></div>
                                    </div>
                                    <div ngbDropdownMenu id="domainChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="Domain"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="domainSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'domain', -1)"> 
                                            Domain
                                        </label>
                                      </li>
                                      <li *ngFor="let domain of teamDomains" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{domain.itemName}}"
                                          style="
                                            white-space: nowrap; 
                                            width: 190px; 
                                            overflow: hidden;
                                            text-overflow: ellipsis; 
                                          ">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="domain.selected" 
                                              value="{{domain.itemName}}" 
                                              (change)="onCompetencyCheckboxChange(domain, $event, 'domain', -1)">
                                                {{domain.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>CM</option>
                                      </select>
                                      <div class="overselect" title="CM"></div>
                                    </div>
                                    <div ngbDropdownMenu id="cmChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="CM"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="cmSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'cm', 0)"> 
                                            CM
                                        </label>
                                      </li>
                                      <li *ngFor="let cm of dataItems[0]" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{cm.itemName}}"
                                          style="
                                            white-space: nowrap; 
                                            width: 190px; 
                                            overflow: hidden;
                                            text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="cm.selected" 
                                              value="{{cm.id}}" 
                                              (change)="onCompetencyCheckboxChange(cm, $event, 'cm', 0)">
                                                {{cm.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>TM</option>
                                      </select>
                                      <div class="overselect" title="TM"></div>
                                    </div>
                                    <div ngbDropdownMenu id="tmChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="TM"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="tmSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'tm', 1)"> 
                                            TM
                                        </label>
                                      </li>
                                      <li *ngFor="let tm of dataItems[1]" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{tm.itemName}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="tm.selected" 
                                              value="{{tm.id}}" 
                                              (change)="onCompetencyCheckboxChange(tm, $event, 'tm', 1)">
                                                {{tm.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                              
                                <div class="multiselect" ngbDropdown style="width:125px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>CM vs TM</option>
                                      </select>
                                      <div class="overselect" title="CM vs TM"></div>
                                    </div>
                                    <div ngbDropdownMenu id="cmVsDmChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 125px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="CM vs TM"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="cmVsDmSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'cmVsDm', -1)"> 
                                            CM vs TM
                                        </label>
                                      </li>
                                      <li *ngFor="let cdm of cmVsDm" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{convertStringToNum(cdm.itemName)}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="cdm.selected" 
                                              value="{{convertStringToNum(cdm.itemName)}}" 
                                              (change)="onCompetencyCheckboxChange(cdm, $event, 'cmVsDm', -1)">
                                                {{convertStringToNum(cdm.itemName)}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>PO</option>
                                      </select>
                                      <div class="overselect" title="PO"></div>
                                    </div>
                                    <div ngbDropdownMenu id="poChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="PO"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="poSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'po', 2)"> 
                                            PO
                                        </label>
                                      </li>
                                      <li *ngFor="let po of dataItems[2]" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{po.itemName}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="po.selected" 
                                              value="{{po.id}}" 
                                              (change)="onCompetencyCheckboxChange(po, $event, 'po', 2)">
                                                {{po.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>PR</option>
                                      </select>
                                      <div class="overselect" title="PR"></div>
                                    </div>
                                    <div ngbDropdownMenu id="prChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="PR"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="prSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'pr', -1)"> 
                                            PR
                                        </label>
                                      </li>
                                      <li *ngFor="let pr of prItems" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{pr.itemName}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="pr.selected" 
                                              value="{{pr.id}}" 
                                              (change)="onCompetencyCheckboxChange(pr, $event, 'pr', -1)">
                                                {{pr.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>VN</option>
                                      </select>
                                      <div class="overselect" title="VN"></div>
                                    </div>
                                    <div ngbDropdownMenu id="vnChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="VN"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="vnSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'vn', 3)"> 
                                            VN
                                        </label>
                                      </li>
                                      <li *ngFor="let vn of dataItems[3]" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{vn.itemName}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="vn.selected" 
                                              value="{{vn.id}}" 
                                              (change)="onCompetencyCheckboxChange(vn, $event, 'vn', 3)">
                                                {{vn.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
                            <th>
                                <div class="multiselect" ngbDropdown style="width:75px">
                                    <div class="selectbox" ngbDropdownToggle>
                                      <select class = "form-control competency-table-drop-down">
                                        <option>CN</option>
                                      </select>
                                      <div class="overselect" title="CN"></div>
                                    </div>
                                    <div ngbDropdownMenu id="cnChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;;width: 75px;">
                                      <li style = "padding-left: 12px;padding-top: 6px;">
                                        <label title="CN"> 
                                          <input 
                                                type="checkbox" 
                                                [(ngModel)]="cnSelectedAll" 
                                                (change)="onCompetencyCheckAll($event, 'cn', 4)"> 
                                            CN
                                        </label>
                                      </li>
                                      <li *ngFor="let cn of dataItems[4]" 
                                          style = "padding-left: 12px;">
                                        <label 
                                          title="{{cn.itemName}}"
                                          style="white-space: nowrap; 
                                          width: 190px; 
                                          overflow: hidden;
                                          text-overflow: ellipsis;">
                                          <input 
                                              type="checkbox" 
                                              [(ngModel)]="cn.selected" 
                                              value="{{cn.id}}" 
                                              (change)="onCompetencyCheckboxChange(cn, $event, 'cn', 4)">
                                                {{cn.itemName}}
                                          </label>
                                      </li>
                                    </div>
                                </div>
                            </th>
  
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngIf = "sortFilterCompetencies?.length == 0">
                            <td colspan="9">
                                No records found with given criteria
                            </td>
                          </tr>
                          <tr *ngFor="let c of sortFilterCompetencies">
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{c.subject.trim()}}">
                              {{c.subject.trim()}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{c.domain}}">
                              {{c.domain}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{showFormattedValue(c.currentMaturity)}}">
                              {{showFormattedValue(c.currentMaturity)}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{showFormattedValue(c.desiredMaturity)}}">
                              {{showFormattedValue(c.desiredMaturity)}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{convertStringToNum(c.cmVsDm)}}">
                              {{convertStringToNum(c.cmVsDm)}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{showFormattedValue(c.priorityOrder)}}">
                              {{showFormattedValue(c.priorityOrder)}} 
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{c.priorityRationale}}">
                              {{c.priorityRationale}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{showFormattedValue(c.valueNext)}}">
                              {{showFormattedValue(c.valueNext)}}
                            </td>
                            <td *ngIf="c.isTextShorten" [clamp]="1" title="{{showFormattedValue(c.complexityNext)}}">
                              {{showFormattedValue(c.complexityNext)}} 
                            </td>
  
                            <td *ngIf="!c.isTextShorten" title="{{c.subject.trim()}}">
                              {{c.subject.trim()}}
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{c.domain}}">
                              {{c.domain}}
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{showFormattedValue(c.currentMaturity)}}">
                              {{showFormattedValue(c.currentMaturity)}}
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{showFormattedValue(c.desiredMaturity)}}">
                              {{showFormattedValue(c.desiredMaturity)}}
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{convertStringToNum(c.cmVsDm)}}">
                              {{convertStringToNum(c.cmVsDm)}}
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{showFormattedValue(c.priorityOrder)}}">
                              {{showFormattedValue(c.priorityOrder)}} 
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{c.priorityRationale}}">
                              {{c.priorityRationale}} 
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{showFormattedValue(c.valueNext)}}">
                              {{showFormattedValue(c.valueNext)}} 
                            </td>
                            <td *ngIf="!c.isTextShorten" title="{{showFormattedValue(c.complexityNext)}}">
                              {{showFormattedValue(c.complexityNext)}} 
                            </td>
  
                            <td 
                              class="collapse-toggle-icon"
                              (click)="toggleShortenCompetencyText(c.id)">
                              <i 
                                class="fa"
                                [class.fa-caret-down] = "c.isTextShorten"
                                [class.fa-caret-up] = "!c.isTextShorten"></i>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                </div>
                <br/><br/>
                <div class = "row">
                  <div class = "col-md-12  ">
                      <a id = "downloadCompetencyData"  (click)="exportFile('competencyTable', 'CompetencyData', 'downloadCompetencyData')"  class="btn btn-primary pull-right">Download</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="panel-group">
          <div class="panel panel-default">
              <div class="panel-heading">
                  <div class="panel-title pull-left">
                    Competency Charts
                  </div>
                  <div class="panel-title pull-right">
                    <a 
                      data-toggle="collapse" 
                      data-parent="#accordion" 
                      href="#competencyChartsIcon" 
                      (click)="changeIcon('competencyChartsIcon')">
                      <i [ngClass]="competencyChartsIcon"></i>
                    </a>
                  </div>
                  <div class="clearfix"></div>
                </div>
            <div id="competencyChartsIcon" class="panel-collapse collapse in">
              <div class="panel-body">
                <div class = "row">
                  <div class = "col-md-12">
                    <div class="panel-group">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important">
                              <div class="panel-title pull-left chartTitle">
                                Current Maturity VS Target Maturity
                              </div>
                              <div class="panel-title pull-right">
                                <a href="#" (click)="downloadCanvas($event, 'cmVsTmGraph')"  class="btn btn-primary"> Download</a>
                              </div>
                              <div class="clearfix"></div>
                            </div>
                        <div id="collapseEditProductInfo" class="panel-collapse collapse in">
                          <div class="panel-body">
                            <div class = "row">
                              <div class="table-responsive" style="padding:0">
                                <canvas id = "cmVsTmGraph" baseChart
                                        [datasets]="cmVsTMRadarData"
                                        [labels]="radarChartLabels"
                                        [options] = "cmVsTmRadarOptions"
                                        chartType="radar"></canvas>
                                  
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="panel-group">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important">
                              <div class="panel-title pull-left chartTitle">
                                Maturity Percentage of each Competency
                              </div>
                              <div class="panel-title pull-right">
                                <a href="#" (click)="downloadCanvas($event, 'maturityPercentageGraph')" class="btn btn-primary"> Download</a>
                              </div>
                              <div class="clearfix"></div>
                            </div>
                        <div id="collapseEditProductInfo" class="panel-collapse collapse in">
                          <div class="panel-body">
                            <div class = "row">
                              <div style="display: block">
                                
                                <canvas id = "maturityPercentageGraph" baseChart
                                        [datasets]="maturityPercentageChartData"
                                        [labels]="radarChartLabels"
                                        [options] = "maturityPercentageOptions"
                                        chartType="radar"></canvas>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="panel-group">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important">
                              <div class="panel-title pull-left" chartTitle>
                              Value VS Complexity (to next maturity)
                              </div>
                              <div class="panel-title pull-right">
                                <a href="#" (click)="downloadPlotGraph($event)" class="btn btn-primary"> Download</a>
                              </div>
                              <div class="clearfix"></div>
                            </div>
                        <div id="collapseEditProductInfo" class="panel-collapse collapse in">
                          <div class="panel-body">
                            <div class = "row">
                                <div class="table-responsive" style="padding:0">
                                    <!-- style="width: 950px; height: 900px;" -->
                                  <div id="scatterPlots" name = "scatterPlots">  
                                      <plotly-plot id = "valueToNextGraph" 
                                                   [data] = "scatterPlotData" 
                                                   [layout] = "layout" 
                                                   [config] = "config">
                                      </plotly-plot>
                                  </div>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel-group">
          <div class="panel panel-default">
              <div class="panel-heading">
                  <div class="panel-title pull-left">
                    Domain Table
                  </div>
                  <div class="panel-title pull-right">
                    <a 
                      data-toggle="collapse" 
                      data-parent="#accordion" 
                      href="#domainTableIcon" 
                      (click)="changeIcon('domainTableIcon')">
                      <i [ngClass]="domainTableIcon"></i>
                    </a>
                  </div>
                  <div class="clearfix"></div>
                </div>
            <div id="domainTableIcon" class="panel-collapse collapse in">
              <div class="panel-body">
                <div class = "row">
                  <div class="table-responsive" style="padding:0; min-height: 500px;">
                    <table class="table table-bordered table-fixed tab removeHand table-domain" 
                      style="text-align:center; width:100%; table-layout:fixed;">
                      <thead>
                        <tr>
                          <th sortDomainColumn [domainSortKey]="'domain'" 
                              [data]="sortFilterDomains" 
                              (click)="sortDomainHeaderClick('domain')" 
                              [ngClass]="sortDomainClass('domain')">Domain Name </th>
                          <th sortDomainColumn [domainSortKey]="'domainAchievement'" 
                              [data]="sortFilterDomains" 
                              (click)="sortDomainHeaderClick('domainAchievement')" 
                              [ngClass]="sortDomainClass('domainAchievement')">% Achievement (Current's % of possible) </th>
                        </tr>
                       <tr>
                          <td>
                          <div class="multiselect" ngbDropdown style="margin: 0 auto;">
                            <div class="selectbox" ngbDropdownToggle>
                              <select  class = "form-control" >
                                <option>Domain</option>
                              </select> 
                              <div class="overselect" title="Domain"></div>
                            </div>
                            <div ngbDropdownMenu id="domainNameChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;">
                              <li style = "padding-left: 12px;padding-top: 6px;">
                                <label title="Domain"> 
                                  <input 
                                        type="checkbox" 
                                        [(ngModel)]="domainNameSelectedAll" 
                                        (change)="onDomainCheckAll($event, 'domainName', -1)"> 
                                    Domain
                                </label>
                              </li>
                              <li *ngFor="let domainName of domainNames" 
                                  style = "padding-left: 12px;">
                                <label 
                                  title="{{domainName.itemName}}"
                                  style="white-space: nowrap; 
                                  width: 190px; 
                                  overflow: hidden;
                                  text-overflow: ellipsis;">
                                  <input 
                                      type="checkbox" 
                                      [(ngModel)]="domainName.selected" 
                                      value="{{domainName.itemName}}" 
                                      (change)="onDomainCheckboxChange(domainName, $event, 'domainName', -1)">
                                        {{domainName.itemName}}
                                  </label>
                              </li>
                            </div>
                          </div>
                          </td>
                          <td>
                            <div class="multiselect" ngbDropdown style="margin: 0 auto;">
                              <div class="selectbox" ngbDropdownToggle>
                                <select  class = "form-control" >
                                  <option>Achievement</option>
                                </select> 
                                <div class="overselect" title="Achievement"></div>
                              </div>
                              <div ngbDropdownMenu id="achievementChecks" class = "checkboxes" style="position:absolute;max-height: 334px; overflow-y: auto;">
                                <li style = "padding-left: 12px;padding-top: 6px;">
                                  <label title="Achievement"> 
                                    <input 
                                          type="checkbox" 
                                          [(ngModel)]="achievementsSelectedAll" 
                                          (change)="onDomainCheckAll($event, 'achievement', -1)"> 
                                          Achievement
                                  </label>
                                </li>
                                <li *ngFor="let achievement of achievements" 
                                    style = "padding-left: 12px;">
                                  <label 
                                    title="{{achievement.itemName}}"
                                    style="white-space: nowrap; 
                                    max-width: 190px; 
                                    overflow: hidden;
                                    text-overflow: ellipsis;">
                                    <input 
                                        type="checkbox" 
                                        [(ngModel)]="achievement.selected" 
                                        value="{{achievement.itemName}}" 
                                        (change)="onDomainCheckboxChange(achievement, $event, 'achievement', -1)">
                                          {{achievement.itemName}}
                                    </label>
                                </li>
                              </div>
                            </div>
                            </td>
                        </tr>
  
                      </thead>
                      <tbody>
                          <tr *ngIf = "sortFilterDomains?.length == 0">
                              <td colspan="9">
                                  No records found with given criteria
                              </td>
                            </tr>
                        <tr *ngFor="let dc of sortFilterDomains">
                          <td title="{{dc.domain.trim()}}">{{dc.domain.trim()}}</td>
                          <td title="{{dc.domainAchievement}}">{{dc.domainAchievement}}</td>
                        </tr>
                      </tbody>
                    </table>
                    <table class="table table-bordered table-fixed table-domain" 
                      style="text-align:center; width:100%;display:none; table-layout:fixed" id = "domainTable">
                      <thead>
                        <tr>
                          <th>Domain Name</th>
                          <th>% Achievement (Current's % of possible)</th>
                        </tr>
                      </thead>
                      <tbody>
                          <tr *ngIf = "sortFilterDomains?.length == 0">
                              <td colspan="9">
                                  No records found with given criteria
                              </td>
                            </tr>
                        <tr *ngFor="let dc of sortFilterDomains">
                          <td>{{dc.domain.trim()}} </td>
                          <td>{{dc.domainAchievement}} </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div>
                    <a id = "downloadDomainData" (click)="exportFile('domainTable', 'DomainData', 'downloadDomainData')"  class="btn btn-primary pull-right">Download</a>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="panel-group">
          <div class="panel panel-default">
              <div class="panel-heading">
                  <div class="panel-title pull-left">
                    Domain Charts
                  </div>
                  <div class="panel-title pull-right">
                    <a 
                      data-toggle="collapse" 
                      data-parent="#accordion" 
                      href="#domainPanelIcon" 
                      (click)="changeIcon('domainPanelIcon')">
                      <i [ngClass]="domainPanelIcon"></i>
                    </a>
                  </div>
                  <div class="clearfix"></div>
                </div>
            <div id="domainPanelIcon" class="panel-collapse collapse in">
              <div class="panel-body">
                <div class = "row">
                  <div class = "col-md-12">
                  
                    <div class="panel-group">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important">
                              <div class="panel-title pull-left chartTitle">
                                Current Maturity VS Possible Maturity.
                              </div>
                              <div class="panel-title pull-right">
                                <a href="#" (click)="downloadCanvas($event, 'dmVsPmGraph')" class="btn btn-primary"> Download</a>
                              </div>
                              <div class="clearfix"></div>
                            </div>
                        <div id="collapseEditProductInfo" class="panel-collapse collapse in">
                          <div class="panel-body">
                            <div class = "row">
                                
                              <canvas id = "dmVsPmGraph" baseChart *ngIf="dmVsPmData?.length > 0"
                                          [datasets]="dmVsPmData"
                                          [labels]="legends"
                                          [options] = "dmVsPmOptions"
                                          chartType="radar"></canvas>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
  
                    <div class="panel-group">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important">
                              <div class="panel-title pull-left chartTitle">
                                Maturity Percentage of each Domain
                              </div>
                              <div class="panel-title pull-right">
                                <a href="#" (click)="downloadCanvas($event, 'maturityPercentageDomainGraph')"  class="btn btn-primary"> Download</a>
                              </div>
                              <div class="clearfix"></div>
                            </div>
                        <div id="collapseEditProductInfo" class="panel-collapse collapse in">
                          <div class="panel-body">
                            <div class = "row">
                              <canvas id = "maturityPercentageDomainGraph" baseChart *ngIf="maturityPercentageData?.length > 0"
                                          [datasets]="maturityPercentageData"
                                          [labels]="legends"
                                          [options] = "maturityPercentageDomainOptions"
                                          chartType="radar"></canvas>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
      </div>      
    </div>
   </div>
  
    
  
    <div 
      class="modal fade centered-modal createAssessment" 
      tabindex="-1" 
      role="dialog" 
      aria-labelledby="exampleModalCenterTitle" 
      data-backdrop="static" 
      data-keyboard="false" 
      aria-hidden="true"
      style="z-index: 9999;">
      
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button (click) = "landToTeamDetailsTab()"
              type="button" 
              class="close" 
              style="color: #ffffff; opacity: 1;"
              data-dismiss="modal">
              <span aria-hidden="true">&times;</span>
              <span class="sr-only">Close</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">
              Create Assessment
            </h4>
          </div>
          <!-- modal body content comes from here-->
          <div class="modal-body">
            <form 
              class = "form-horizontal" 
              id = "formNewAssessment" 
              name = "formNewAssessment"
              #assessmentData = "ngForm"
              (ngSubmit) = "createAssessment(assessmentData.value)">
              <div class="col-md-12">  <label class="col-md-12" style="text-align:center;color:red;font-weight:normal" for="name" *ngIf = "assessments?.length == 0">No Assessments found. Please create new one.</label> </div> 
              <div class="form-group">
                  <label class="control-label col-md-4" for="name">Assessment Name*</label>
                  <div class="col-md-6">
                    <input 
                      type="text" 
                      name="assessmentName" 
                      id="assessmentName" 
                      placeholder="Enter Assessment Name"
                      class="form-control"
                      [ngClass]=
                          "{	'form-invalid' : assessmentErrors?.assessmentName, 
                            'form-valid' : !assessmentErrors?.assessmentName 
                        }"
                      [(ngModel)]="assessmentName">
                      <div class="form-error-text" *ngIf = "assessmentErrors?.assessmentName">
                        <span class="text text-danger">
                          {{assessmentErrors.assessmentName}}
                        </span>
                      </div>
                  </div>
                </div>
              
                  <div class="row"></div>
                  <br>
                <div class="row">
                  <div class="col-xs-12">
                    <div class="text-right">
                      <button 
                        type="button" 
                        class="btn btn-secondary" 
                        id="cancel-btn-create-assessment" 
                        data-dismiss="modal"
                        (click)="landToTeamDetailsTab()">Cancel</button>
                      <input type="submit" class="btn btn-primary" value = "Create">
                    </div>
                  </div>
                </div>
            </form>
        </div>
      </div>
    </div>
    </div>
    <div class="modal fade centered-modal" 
        id="updateTeam" 
        tabindex="-1" 
        role="dialog" 
        aria-labelledby="exampleModalCenterTitle" 
        data-backdrop="static" 
        data-keyboard="false" 
        aria-hidden="true"
        style="z-index: 9999;">
        
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button 
                type="button" 
                class="close" 
                style="color: #ffffff; opacity: 1;"
                data-dismiss="modal">
                <span aria-hidden="true">&times;</span>
                <span class="sr-only">Close</span>
              </button>
              <h4 class="modal-title" id="myModalLabel">
                Update Team
              </h4>
            </div>
            <!-- modal body content comes from here-->
            <div class="modal-body">
              
              <div
                id = "isTeamError"
                name = "isTeamError"
                class="alert alert-danger fade in alert-dismissible"
                [ngStyle]="{ 'display' : errorMessage }"
                *ngIf = "teamErrors">
                <a 
                  class="close" 
                  aria-label="close" 
                  title="close" 
                  (click)="displayToggle()">
                </a>
                  Please provide the required information for the indicated field(s).
              </div>
  
              <form 
                class = "form-horizontal" 
                id = "formNewTeam" 
                name = "formNewTeam"
                #teamData = "ngForm"
                (ngSubmit) = "updateTeam(teamData.value)">
              
                <div class="row">
                  <div class="col-md-6">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important;">
                            <div class="row">
                              <div class="col-md-12">
                                <h4 class="panel-title">
                                  Team Information
                                </h4>
                              </div>
                            </div>
                          </div>
                          <div id="collapse1" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <div class="form-group">
                                <label class="control-label col-md-4" for="name">Team Name*</label>
                                  <div class="col-md-8">
                                    <input 
                                      value = "{{team?.name}}"
                                      title="{{team?.name}}"
                                      type="text" 
                                      name="teamName" 
                                      id="teamName" 
                                      placeholder="Team Name"
                                      class="form-control"
                                      [(ngModel)]="teamName" 
                                      [ngClass]=
                                      "{	'form-invalid' : teamErrors?.teamName, 
                                            'form-valid' : !teamErrors?.teamName
                                      }"             >
                                    <div class="form-error-text" *ngIf = "teamErrors?.teamName">
                                      <span class="text text-danger">
                                        {{teamErrors.teamName}}
                                      </span>
                                    </div>
                        
                          
                                  </div>
                              </div>
                              <div class="form-group">
                                <label class="control-label col-md-4" for="team-description">Description*</label>
                                  <div class="col-md-8">
                                    <textarea         
                                      value = "{{team?.description}}"
                                      title = "{{team?.description}}"                       
                                      name="teamDescription" 
                                      id="teamDescription" 
                                      rows="5"
                                      [(ngModel)]="teamDescription"
                                      class="form-control"
                                      [ngClass]=
                                        "{	'form-invalid' : teamErrors?.teamDescription, 
                                            'form-valid' : !teamErrors?.teamDescription
                                          }"             
                                      >
                                    </textarea>
                                    <div class="form-error-text" *ngIf = "teamErrors?.teamDescription">
                                      <span class="text text-danger">
                                        {{teamErrors.teamDescription}}
                                      </span>
                                    </div>
                                  </div>
                              </div>
                              <div class="form-group">
                                  <label class="control-label col-md-4" for="customer">Strategist*</label>
                                  <div class="col-md-8"> 
                                    <select
                                      value = "{{team?.strategist?.username}}"
                                      [(ngModel)] = "strategist"
                                      name="strategist" 
                                      title="{{strategistNameTitle}}"
                                      (change)= onStrategistChange($event)
                                      class="form-control" 
                                      id="strategist"
                                      [ngClass]=
                                        "{	'form-invalid' : teamErrors?.strategist, 
                                          'form-valid' : !teamErrors?.strategist 
                                      }">
                                      <option disabled value = " " title="Select Strategist">
                                        Select Strategist
                                      </option>
                                      <option *ngFor="let s of strategists"  value = "{{s.username}}" title="{{s.firstName}} {{s.lastName}}">
                                          {{s.firstName}} {{s.lastName}}
                                       </option>
                                      </select>
                                      <div class="form-error-text" *ngIf = "teamErrors?.strategist">
                                          <span class="text text-danger">
                                            {{teamErrors.strategist}}
                                          </span>
                                        </div>
                                  </div>
                                  
                                </div>
                              <div class="form-group">
                                <label class="control-label col-md-4" for="team-contact">Contacts</label>
                                <div class="col-md-8">
                                  <textarea 
                                    value = "{{team?.contact}}"
                                    name="teamContact" 
                                    id="teamContact" 
                                    title="{{team?.contact}}"
                                    rows="5"
                                    [(ngModel)]="teamContact"
                                    class="form-control"
                                    [ngClass]=
                                        "{	'form-invalid' : teamErrors?.teamContact, 
                                            'form-valid' : !teamErrors?.teamContact
                                          }"             
                                      >>
                                  </textarea>
                                  <div class="form-error-text" *ngIf = "teamErrors?.teamContact">
                                    <span class="text text-danger">
                                      {{teamErrors.teamContact}}
                                    </span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>  
                      </div>
                  </div>
                  <div class="col-md-6">
                      <div class="panel panel-default">
                          <div class="panel-heading" style="background-color: #6d6f71 !important;">
                              <div class="row">
                                <div class="col-md-12">
                                  <h4 class="panel-title">
                                    Linked Products
                                  </h4>
                                </div>
                              </div>
                          </div>
                          <div id="collapse1" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <p-pickList 
                                [source]="sourceProducts" 
                                [target]="targetProducts" 
                                sourceHeader="Available" 
                                targetHeader="Selected" 
                                [responsive]="true"
                                dragdrop="true" 
                                dragdropScope="products" 
                                [sourceStyle]="{'height':'322px'}" 
                                [targetStyle]="{'height':'322px'}">
                                <ng-template let-products pTemplate="item">
                                  <div class="ui-helper-clearfix">
                                    <div 
                                      title="{{products.name}}"
                                      style="
                                      white-space: nowrap; 
                                      width: 160px; 
                                      overflow: hidden;
                                      text-overflow: ellipsis;">
                                      {{products.name}}
                                    </div>
                                  </div>
                                </ng-template>
                              </p-pickList>
                            </div>
                          </div>
                      </div>
                  </div>
                </div>
                <div class="row"></div>
                <br>
                <div class="row">
                  <div class="col-xs-12">
                    <div class="text-right">
                      <button type="button" id="cancel-btn-upd-team" class="btn btn-secondary" data-dismiss="modal" (click)="teamDefaults()">Cancel</button>
                      <input type="submit" class="btn btn-primary" value = "Save">
                    </div>
                  </div>
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>